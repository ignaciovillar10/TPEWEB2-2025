<?php require 'app/views/partials/header.php';

require_once 'app/models/Producto.model.php';
require_once'router.php';
$productoModel = new Producto();
$productos = $productoModel->getAll();
?>

<div class="d-flex justify-content-between align-items-center mb-4">
	<h1>Bienvenido a la Cafetería</h1>
        <?php if(isset($usuario)):?>
			<h5>Hola, <?= htmlspecialchars($usuario) ?></h5>	
	<a class="btn btn-primary" href="index.php?action=productos">Ver todos los productos</a>
</div>

<?php if (empty($productos)): ?>
	<div class="alert alert-info">No hay productos para mostrar.</div>
<?php else: ?>
	<div class="row row-cols-1 row-cols-md-3 g-4">
		<?php foreach ($productos as $p): ?>
			<div class="col">
				<div class="card h-100">
					<?php if (!empty($p['imagen'])): ?>
						<img src="<?= htmlspecialchars($p['imagen']) ?>" class="card-img-top" alt="<?= htmlspecialchars($p['nombre']) ?>">
					<?php else: ?>
						<svg class="bd-placeholder-img card-img-top" width="100%" height="180" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder" preserveAspectRatio="xMidYMid slice" focusable="false"><title>Imagen</title><rect width="100%" height="100%" fill="#868e96"></rect><text x="50%" y="50%" fill="#dee2e6" dy=".3em" text-anchor="middle">Sin imagen</text></svg>
					<?php endif; ?>
					<div class="card-body d-flex flex-column">
						<h5 class="card-title"><?= htmlspecialchars($p['nombre']) ?></h5>
						<p class="card-text mb-1"><small class="text-muted"><?= htmlspecialchars($p['categoria_nombre'] ?? 'Sin categoría') ?></small></p>
						<p class="card-text text-success fw-bold">$<?= number_format($p['precio'], 2, ',', '.') ?></p>
						<?php if (isset($p['stock'])): ?>
							<p class="card-text"><small>Stock: <?= (int)$p['stock'] ?></small></p>
						<?php endif; ?>
						<div class="mt-auto">
							<a href="detallarProducto/<?= htmlspecialchars($p['id_producto'])?>" class="btn btn-sm btn-outline-primary">Ver</a>
							<a href="#" class="btn btn-sm btn-primary">Agregar</a>
						</div>
					</div>
				</div>
			</div>
		<?php endforeach; ?>
	</div>
<?php endif; ?>
<?php require 'app/views/partials/footer.php';?> 